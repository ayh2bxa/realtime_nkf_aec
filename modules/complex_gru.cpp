#include "complex_gru.h"
#include "gru.h"
#include "matrix_helper.h"
#include <iostream>
#include <utility>
#include <cerrno>

ComplexGRU::ComplexGRU(int in_dim, int hidden_dim): h(hidden_dim), gru_r(in_dim, hidden_dim), gru_i(in_dim, hidden_dim) {
  int numBins = 513;
  out_real.resize(h*numBins);
  out_imag.resize(h*numBins);

  gru_r.Wrx = {
    0.15899512, -0.030687671, -0.02880255, -0.036504667, -0.10886498, 0.0818851, 0.058135666, -0.04623163, 0.017819231, 0.04876266, 0.04652994, -0.004734398, -0.01752374, 0.09665942, 0.0011341649, -0.020739129, -0.016998954, -0.0006437803,
    -0.053353764, -0.004406954, -0.013601295, 0.07480628, -0.27572945, -0.015157564, -0.31171536, -0.13385573, -0.12861983, -0.04043339, 0.042537097, -0.0715825, -0.0661124, 0.049205568, 0.25846446, 0.023856986, 0.12131514, 0.04907585,
    0.22536445, -0.13572147, 0.087393925, -0.06258481, -0.17105937, -0.26201028, -0.08183439, -0.2704748, 0.04548794, -0.13369577, 0.02439355, 0.027324475, -0.006483861, -0.2054069, -0.26034144, -0.038780145, 0.09919023, 0.05081153,
    0.08805096, -0.048120305, -0.04274879, -0.13379678, 0.10723825, 0.24291846, -0.09669349, -0.07416079, 0.0074597714, -0.11375471, 0.00047395218, 0.04439432, 0.03829043, 0.24204087, -0.0147762615, -0.061538104, 0.12432318, 0.19158651,
    -0.027500274, -0.06473065, -0.2297619, 0.05650014, -0.1762015, 0.00014123006, -0.26030546, -0.13195054, -0.08538198, -0.1443595, -0.15896325, -0.11489452, -0.007730521, -0.06386599, 0.13669486, 0.044784818, -0.18614425, -0.05894104,
    0.09482803, -0.0009448265, 0.08346788, 0.02752247, -0.1113298, -0.011722613, -0.1582766, -0.10005013, 0.10626833, -0.07481013, -0.14634864, 0.034735538, 0.02573876, -0.00904487, -0.15333083, -0.0076183076, 0.009444388, 0.03800655,
    -0.28658682, -0.12403312, 0.08050412, -0.015751012, -0.2782475, -0.40305015, 0.012087999, 0.054849148, 0.050270855, 0.20744294, 0.25809082, -0.093720265, -0.13358764, -0.17815264, 0.151466, -0.19223566, -0.2001768, -0.14695844,
    -0.020764602, -0.07673903, -0.024742903, -0.06794101, -0.12186203, -0.10354764, 0.039116286, -0.115490906, 0.0061291032, -0.08470947, 0.054309364, -0.037749004, 0.0076772133, -0.0853725, -0.02990639, -0.029427933, 0.10819553, 0.024746494,
    0.05944752, 0.04966639, -0.15539293, 0.020960817, 0.007901392, 0.11955035, 0.06442324, 0.106955744, -0.0009899497, 0.15046898, 0.19178413, -0.13113844, 0.029123032, 0.15780346, 0.1534955, 0.06595397, -0.06402883, 0.014100307,
    0.12771387, 0.03267043, -0.2528755, 0.12153933, 0.14101686, -0.04259865, 0.2845329, -0.037325732, 0.111911535, -0.0065949387, 0.08929649, -0.049668625, 0.05416482, -0.01700655, 0.047579132, -0.13319445, -0.21768004, 0.039411422,
    -0.25996265, 0.021946983, -0.25030774, 0.13222224, 0.17375436, -0.00048429816, 0.11548841, 0.12424032, -0.10427725, 0.102056846, 0.054077946, -0.110738404, -0.006516312, -0.09578163, 0.28209767, -0.0017701583, -0.070270166, -0.09029511,
    -0.06545577, -0.11297027, -0.11362756, 0.07261407, -0.115800284, -0.12042948, -0.11440203, 0.03597087, -0.035806745, -0.08390305, -0.10587191, -0.023759726, -0.11144852, -0.003050719, 0.03854873, -0.21745777, -0.0387918, 0.004559248,
    0.020927507, -0.05164735, -0.121027954, 0.019027429, 0.0068832217, -0.29836932, 0.028583867, 0.11030796, -0.09786333, -0.005726995, 0.1448679, 0.093048155, -0.1815632, -0.09780292, 0.13578252, -0.097809985, 0.09336819, 0.024613237,
    0.06914346, -0.06801267, -0.01847154, -0.09063658, -0.16144463, -0.053068984, -0.016856235, -0.06267115, -0.0016483519, -0.06286923, 0.015298129, 0.06768868, -0.060290247, -0.04034652, -0.06367107, -0.05449246, 0.113658994, -0.016758107,
    -0.09070577, 0.026734194, -0.22301367, 0.057068583, -0.10723097, 0.035236586, -0.06282236, 0.08007485, -0.09850272, 0.23729429, -0.054562096, -0.1104845, 0.07418967, -0.012643605, 0.2625851, 0.011262911, 0.08684249, -0.17112754,
    -0.087433785, 0.10772801, -0.18317726, 0.023964526, 0.743243, -0.44794717, 0.6401609, 0.3446564, -0.3414376, 0.23842405, 0.22036798, -0.6285719, -0.11919113, -0.34222272, 0.18766126, -0.20348339, -0.6244308, 0.05633964,
    0.15433103, -0.12543565, 0.14676782, 0.2013003, 0.04722316, -0.21542576, 0.16900542, 0.08240848, 0.25750947, 0.090353414, 0.10603757, 0.2342421, 0.06019128, -0.19823897, -0.082048275, -0.097385265, 0.055488322, -0.10336539,
    -0.08339269, -0.050085414, -0.1708491, 0.09739775, -0.071150936, -0.026842827, -0.08029348, 0.10857851, 0.057691433, -0.03286297, 0.004706957, 0.011246273, -0.049959, 0.07408081, 0.15610158, -0.05984629, 0.029288556, -0.06181446,
  };

  gru_r.Wzx = {
    0.013911635, 0.006049313, 0.12425643, -0.014667393, 0.035214975, -0.08980446, 0.024018561, 0.031747706, 0.12544034, 0.042155802, -0.06710856, 0.032931417, 0.035299227, -0.09234205, -0.18203941, 0.018686024, 0.11458687, -0.05583303,
    -0.04949289, -0.010862039, 0.110584505, 0.048604373, -0.25507116, 0.01265244, -0.17747353, 0.06525821, -0.2826095, -0.12121814, -0.14715514, -0.0898022, 0.010138815, 0.08043378, -0.12487908, -0.027233638, -0.123907246, -0.17293072,
    0.1054566, 0.028855857, -0.15811782, -0.13029745, 0.15946895, -0.030944642, -0.07400366, -0.06068859, 0.069500566, 0.007640976, -0.10450508, 0.038818773, 0.022734132, -0.08972086, -0.19086921, 0.05010241, -0.03685956, 0.05835318,
    0.07918449, 0.07363997, 0.098482646, -0.26319474, 0.01757836, -0.05399411, 0.0057072346, -0.022508219, 0.14013933, -0.01952743, -0.039973363, -0.13371257, 0.028553609, -0.1131629, -0.26425004, -0.011800553, -0.06644888, -0.12588611,
    -0.12205791, 0.08210403, 0.046971817, 0.05182541, -0.027601808, -0.027178578, 0.011887786, -0.039841242, -0.29371715, -0.0012755505, -0.117803894, 0.048584353, -0.07349363, 0.01338576, 0.053334255, -0.0118771875, 0.10154435, 0.071898244,
    0.06413174, -0.11670964, 0.061177686, 0.06717588, -0.16233696, 0.003773492, -0.18291964, -0.055421133, -0.018795542, 0.041334987, 0.09496614, 0.10303594, 0.006855223, -0.019481996, -0.26047242, -0.0075193103, 0.088275075, -0.042650912,
    -0.05158244, 0.0009488155, 0.0184633, -0.049589727, 0.043605283, 0.05639649, -0.04222393, -0.068647176, -0.06586265, 0.053616192, -0.08536245, -0.042283796, -0.10299064, 0.037415005, 0.03591755, -0.020323202, -0.03753833, -0.13613965,
    0.031316012, -0.05580427, 0.01826862, 0.03795805, -0.017952751, -0.02037649, -0.030612782, -0.0023758956, -0.17629598, 0.05700206, -0.12794407, -0.0019394072, 0.017077265, -0.12376898, 0.029601851, 0.062730014, -0.05341321, 0.11238002,
    0.09303876, -0.06016039, 0.055274334, 0.047091614, 0.018734964, -0.016844165, 0.059161738, 0.09726354, -0.053663827, 0.07838128, -0.07502003, -0.05049601, 0.034669876, -0.055200867, -0.2985269, 0.008079857, -0.18664512, 0.10053768,
    0.03711969, -0.03133772, -0.024523735, -0.0019807087, -0.003368301, 0.007724194, -0.012790227, -0.024578331, 0.019807637, 0.047266465, -0.014381858, 0.017885672, -0.00062346685, -0.029140018, -0.066082716, 0.012451818, 0.008975136, -0.002974783,
    0.04781913, -0.08441619, 0.01233813, -0.021221777, -0.025680853, 0.0054293317, 0.035122048, -0.0063531743, -0.018485343, -0.057662655, 0.012236495, -0.00027540818, 0.019188132, -0.017033648, 0.04764655, -0.010222987, 0.04934958, 0.013067109,
    0.016210666, -0.06993823, 0.047448657, -0.009158971, 0.002027622, 0.0072370768, -0.0133379605, 0.035149537, -0.05047751, 0.01693233, 0.08721416, -0.04962466, -0.1660635, 0.039593164, -0.09606988, -0.18462956, 0.0010646, -0.07298691,
    -0.042847775, -0.11233504, 0.16128023, -0.0719155, 0.052397553, 0.024835404, -0.010546748, 0.003896747, 0.0280648, -0.39912573, -0.019074615, -0.0007093804, 0.04614843, 0.087481774, -0.15528432, -0.019053005, -0.11129769, -0.10321101,
    0.014671274, -0.08843891, -0.039895065, -0.1587257, -0.080540925, -0.0010940952, 0.0027740165, -0.12532061, -0.044902183, -0.27402225, 0.02244656, -0.0061119576, -0.06503665, 0.007088306, -0.34403816, -0.04740031, -0.14590144, -0.029477455,
    0.09084972, -0.006578548, 0.057535827, 0.04904285, 0.05685777, 0.015685704, -0.17068227, -0.12632738, 0.0708198, -0.003505907, 0.03573809, 0.0045963507, -0.05907113, -0.030897334, 0.0051219217, -0.011296992, 0.004874464, -0.048198268,
    0.056254752, 0.18231024, 0.06536805, -0.020078335, 0.099612966, -0.028732326, -0.061330482, 0.004271637, -0.1928065, -0.02293982, -0.011911428, -0.2920045, 0.021894535, 0.04356995, 0.0037805818, -0.0121333115, -0.41084605, 0.034085754,
    -0.038916584, 0.09632671, -0.061216686, -0.07594986, -0.08796663, -0.13995464, 0.0042920723, -0.031455684, -0.035362396, 0.023661707, -0.02899533, -0.03132869, -0.05381185, -0.054108113, -0.07481117, -0.10723588, -0.059434615, -0.024471398,
    -0.016038446, 0.090173416, -0.27018183, -0.28540027, -0.0023560408, -0.023387132, -0.048952922, -0.07071125, 0.14373614, 0.1829922, -0.17087956, 0.055247117, 0.013024816, -0.02855161, -0.083753176, 0.05387727, 0.07958977, 0.0031137075,
  };

  gru_r.Wnx = {
    0.13243678, -0.046685252, 0.38536265, 0.5892298, -0.19412383, -0.13678013, -0.3174658, 0.4101188, 0.23347373, 0.06264682, 0.12004084, 0.08168334, 0.22861525, -0.1990035, 0.25904244, 0.17489707, 0.3179119, 0.27249888,
    -0.36922383, -0.27099067, 0.07419283, 0.26281166, -1.4711618, -0.021137754, -1.1669848, -0.46515954, -0.28740627, -0.35965842, -0.2532903, -0.064602494, -0.16406544, -0.08109864, 0.41264412, -0.067561574, 0.31413838, -0.2900229,
    0.03027526, -0.2057461, 0.26469138, 0.4029836, -0.2692878, -0.05695263, -0.73148984, 0.037793536, 0.32042107, -0.37053907, -0.40714756, -0.042810578, 0.09366111, -0.11705281, 0.4295514, -0.047117144, 0.19520222, -0.24179016,
    -0.5132691, -0.26199794, -0.7719712, -0.66679114, 0.18679333, -0.3525227, 0.39613873, -0.12873363, -0.11154408, 0.40027577, 0.30162105, -0.09280672, 0.19307058, -0.28151986, -0.26448998, -0.048410673, 0.09341979, 0.033642046,
    0.33177254, 0.47158566, 0.4786124, -0.08214814, 0.096404344, 0.2844544, -0.22518767, -0.97053427, 0.809712, -0.5493512, 0.37033072, 0.32408485, 0.34580994, 0.0914081, -0.638992, 0.38773382, -0.16954492, 0.19736914,
    0.10871623, -0.11804994, 0.036531206, 0.0053037656, -1.7481006, 0.061679013, -0.58804023, -1.0896311, 0.5463316, -0.00011411585, -0.21311834, 0.53793454, -0.3869794, -0.14840098, -0.97252584, -0.1147749, 0.72745895, 0.0013081761,
    0.0820379, -0.05787808, -0.10627409, 0.4766221, 0.10430843, 0.02487646, -0.30557597, -0.14378664, 0.13147362, -0.1216402, 0.10742085, 0.025681788, 0.24960509, 0.045545522, 0.05453911, 0.015107419, -0.08717648, -0.5927947,
    0.116936766, -0.02252147, -0.1714483, -0.032357402, -0.1559341, 0.13182637, -0.13118285, 0.21766396, -0.34255177, -0.090302624, -0.3734566, 0.080942765, -0.019440334, 0.09102638, 0.18000558, 0.12069717, -0.01208592, -0.07857035,
    0.26909012, -0.010275569, -0.044455774, -0.18214083, -0.5950319, 0.20020656, -0.070263706, 0.024671413, 0.1962671, -0.033486865, -0.029549267, 0.35039017, 0.0872747, 0.14403358, -0.29113743, 0.12888546, 0.3216436, -0.061808247,
    -0.13776988, 0.1239817, 0.21928518, 0.20743454, -0.0805562, 0.036105797, 0.03722897, 0.11844644, -0.21632141, -0.21974614, -0.1102277, -0.05239256, 0.0042080074, 0.076086484, 0.40216392, 0.028503183, 0.26621333, -0.21693271,
    0.113881655, -0.742348, 1.1651641, -0.28185686, -0.076579146, -0.31568885, 0.13272677, -0.033987585, 0.059210334, -1.3275306, -0.17722064, 0.17806438, -0.15986857, -0.25084537, 0.04702575, -0.22693817, 0.48214743, -0.1299898,
    -0.65575767, 0.030498333, -0.5130892, -0.27310532, -0.32607946, 0.11400732, -0.13857464, -0.35637304, -0.3927221, 0.09044747, -0.16877525, -0.51094145, 0.2902364, -0.25705993, 0.18957253, 0.47398686, 0.0059568617, -0.6222459,
    -0.24973266, 0.3963994, -0.39085355, 0.11427764, -0.06331844, -0.013344409, 0.08800289, 0.43658608, -0.2663662, 1.3002462, 0.0060049817, 0.018337326, -0.10316954, 0.059888758, 0.5305308, -0.030474361, 0.1635465, 0.1445841,
    -0.14306794, -0.42942172, -0.49095124, -1.0227594, -0.3122273, -0.4796248, -0.20454873, -0.3044735, 0.1668956, -0.22671703, -0.10061263, -0.16409208, -0.5005192, -0.32147548, -0.45755592, -0.87163216, -0.10629588, 0.56129885,
    0.071251765, 0.011203722, -0.15927564, -0.4031174, -0.15791367, 0.2365325, 0.1517878, 0.3513916, -0.5735949, 0.041653354, 0.00025549857, 0.23459943, 0.15229796, 0.2918286, 0.2007454, 0.1945681, 0.107125826, 0.18317352,
    0.32596952, 0.10960399, 0.131421, -0.20908399, 0.38775653, -0.0059383973, -0.012822697, -0.06211853, -0.7671664, -0.2833031, -0.05923761, -1.4165432, -0.08121329, -0.21333192, 0.33275494, 0.056873154, -1.415989, 0.18530458,
    0.00017049776, 0.24212475, 0.18154259, -0.02897109, 0.22677678, 0.19189294, 0.10906878, -0.1429159, 0.28201905, -0.3591708, -0.24343821, -0.16540669, 0.12811986, 0.2591577, 0.19191019, 0.08057811, -0.17926927, 0.38029248,
    -0.35624623, -0.1475905, -0.6908271, 0.5392516, 0.12458871, -0.09786269, -0.39828512, -0.039749596, 0.12494582, 0.5704814, -0.52266675, 0.072292425, 0.12818758, -0.071943395, -0.083154574, -0.04570498, -0.06666571, -0.53881323,
  };

  gru_r.Wrh = {
    -0.010385653, 0.026117114, 0.15469423, -0.0432427, 0.1619839, 0.07913642, 0.12843096, -0.088597156, -0.052866682, -0.046024572, 0.020539427, -0.036733422, 0.0149254585, 0.024483379, -0.10202225, -0.09781833, 0.18983546, 0.12909935,
    0.086782284, 0.049524654, -0.07475043, 0.023442177, 0.055576436, -0.32639012, 0.009450826, -0.1337255, -0.09368971, -0.08558312, -0.031028152, -0.13624817, 0.09565341, -0.09326913, -0.018487291, 0.16807164, -0.2549257, -0.042720146,
    -0.16362555, 0.20021081, 0.021709492, 0.15340553, -0.16077858, -0.030982682, -0.030671192, -0.3275839, -0.3042388, -0.029553754, 0.18194142, -0.060698126, -0.013170514, 0.043579746, 0.07427354, 0.12602165, 0.23868887, 0.1927636,
    -0.058016602, -0.0076920963, -0.03316599, -0.03206018, 0.08230203, -0.04321587, 0.038991693, -0.10141038, -0.026364343, -0.021113353, -0.057786603, -0.060905777, 0.03857446, -0.026786529, -0.06426062, 0.12111588, 0.16012849, 0.023034118,
    0.03684747, 0.3238594, 0.2477718, -0.018143104, -0.15497537, 0.08428984, -0.0618533, -0.3552976, -0.25531507, -0.23710486, 0.015690869, 0.010288601, 0.18885198, 0.25980133, -0.006559316, 0.19788164, 0.09447881, 0.12704536,
    0.06146581, 0.4361386, 0.13248101, 0.05336453, -0.12403967, 0.19862181, 0.1631778, -0.367264, 0.0023816812, -0.13217454, -0.04761085, -0.1539368, 0.28560704, 0.1856244, 0.12439744, -0.27773848, 0.10631514, 0.17178707,
    0.12024737, -0.26879066, -0.029365655, 0.10958465, -0.43371353, 0.03843375, -0.19998656, -0.3296397, -0.29398784, -0.13091742, 0.17226893, -0.23467976, 0.073208295, -0.042176127, 0.16563451, -0.18861823, 0.28103736, 0.13341242,
    -0.08024845, 0.09003016, -0.049041238, 0.118938945, -0.052848518, -0.08876304, 0.051499713, -0.17379594, -0.076713026, -0.16825922, 0.017890122, -0.09879304, -0.002211523, 0.06624958, 0.038239717, 0.0012353704, -0.07483001, 0.0101940865,
    -0.02315103, 0.022315644, -0.027238218, -0.055985775, 0.01302956, -0.13952899, 0.06622027, -0.051812604, 0.04532969, 0.0032619154, 0.072937876, -0.07191956, -0.032912306, -0.13518819, 0.08285027, -0.010968533, 0.0069161872, -0.08917061,
    0.01001677, 0.047860865, 0.051605947, 0.07713755, -0.047530144, 0.10572386, 0.10251595, -0.13137439, 0.008001738, -0.09612523, 0.15425713, -0.117140725, -0.035008382, -0.07785488, 0.0038285023, -0.014745119, -0.03858462, 0.09440563,
    0.03435432, -0.11574513, -0.04599438, -0.008532466, -0.11070286, 0.0044699116, -0.0029060345, -0.16830184, -0.24801172, -0.1699986, -0.0816311, -0.11999901, 0.077110775, -0.11073335, 0.08849299, 0.0073043774, 0.20521702, 0.052402508,
    -0.032836974, 0.075020194, 0.050478376, -0.036298364, -0.049776614, -0.0014522943, 0.028746145, -0.058731597, -0.03294449, -0.12347806, -0.053768635, -0.063707486, -0.06588982, -0.06250981, 0.15325753, -0.0861173, 0.20951092, 0.11199915,
    0.04292985, -0.16340092, -0.024970906, 0.11249118, -0.19394422, 0.06010617, 0.03467249, -0.39929774, -0.27731946, -0.15946306, 0.19440213, -0.28724, -0.00543112, 0.052045986, 0.12225162, 0.000866225, 0.27026868, 0.20402066,
    -0.1568765, 0.023261955, -0.0783726, 0.15409572, -0.08327686, -0.22390522, -0.07218848, -0.15390408, -0.10662478, -0.067019954, 0.015962772, 0.073489584, -0.004750518, 0.03319845, 0.04846033, 0.20776144, -0.003825873, -0.098882675,
    0.023255121, 0.16216981, -0.09088954, -0.0385601, -0.46453977, -0.069537155, -0.31337628, -0.21582834, -0.03348721, -0.11299411, 0.24523084, -0.120291635, -0.082542524, -0.16725114, 0.4098913, -0.0075091897, 0.2816014, 0.19373612,
    0.13041918, -0.5600022, 0.1973756, -0.017488545, -0.1281697, -0.15250443, 0.17368276, 0.15506709, -0.12007305, 0.10593411, 0.014750115, 0.02333695, -0.012879019, -0.091666825, -0.42945185, 0.35347512, 0.23264728, 0.23029943,
    0.09046047, -0.22585194, 0.05158888, -0.052396283, -0.02352349, -0.012057803, 0.05398505, -0.109656334, -0.20682034, -0.060181208, -0.002804811, -0.18561758, 0.10572174, -0.17170939, 0.0060245055, 0.031013755, 0.010165464, 0.003406086,
    -0.119071215, 0.13234393, 0.017076239, 0.143035, -0.25905854, 0.19360933, 0.11171801, -0.38727808, -0.10010802, -0.26413435, 0.06109563, -0.18924817, 0.08372587, 0.1347737, 0.18225205, -0.46029717, 0.13244331, 0.31068254,
  };

  gru_r.Wzh = {
    0.19822647, -0.032378774, -0.0073224036, 0.09264099, -0.15716985, 0.1971116, -0.16618209, 0.14860554, 0.08550002, 0.1056983, -0.06044255, 0.119772695, 0.05185259, 0.035204843, -0.02529439, 0.07265564, 0.117177695, 0.054536797,
    0.17942056, -0.29127315, -0.24976975, -0.22486207, -0.009258111, -0.20199856, -0.09717507, 0.23742855, 0.1868612, 0.283344, 0.01750965, -0.046434887, 0.16539118, -0.45104578, 0.14848968, -0.11686964, -0.21955416, -0.16142422,
    0.06680539, -0.17371383, -0.12513371, 0.035368074, 0.24184223, 0.032032408, 0.15433252, 0.13535628, 0.2838828, 0.16681649, 0.19007275, 0.010822124, -0.1399145, -0.1355461, -0.23324431, -0.08526288, 0.05058973, 0.0010097424,
    0.03710324, -0.16332035, -0.10522144, -0.07169924, 0.09309153, -0.020470573, -0.20649607, 0.28619874, 0.25503698, 0.30291834, -0.08081998, 0.18562229, -0.015363597, -0.13984789, -0.0059153307, 0.015929691, 0.14590766, -0.26227033,
    0.1242994, -0.50200754, -0.16871597, -0.23361702, 0.2605624, -0.08782738, 0.102938086, 0.09651057, 0.081087105, 0.17841893, -0.016935458, 0.041429944, -0.1639211, -0.31000176, -0.29239526, 0.13108382, 0.23357889, -0.20042633,
    0.19522735, -0.43329942, -0.28546596, -0.23035046, -0.15309699, -0.077341974, -0.327126, 0.25498474, 0.20371257, 0.34231114, 0.31487647, -0.1340732, -0.0061834296, -0.41057956, 0.021829724, 0.118344955, -0.038076315, -0.16342117,
    -0.054238986, -0.0054764776, 0.0050435774, -0.08831851, 0.30944818, 0.09684238, 0.13874735, 0.26297873, 0.38387278, 0.25289834, -0.14138123, 0.28454152, -0.13941793, 0.10436243, -0.112279676, -0.054668296, 0.048636712, -0.026092751,
    0.0027076514, -0.08155127, -0.03235547, 0.03569349, 0.020592473, 0.07345286, -0.010762261, -0.08792207, -0.09139244, 0.13437042, -0.040048994, 0.058876052, 0.052990682, 0.00342488, -0.07336087, 0.05027158, 0.053138692, -0.010590505,
    -0.023336297, -0.11751789, -0.11264249, 0.07657332, -0.13617153, 0.017021645, -0.19353376, 0.24229343, -0.1952009, 0.21411426, -0.13422365, 0.17124125, 0.020489458, 0.05060547, -0.064919, 0.09941801, -0.022199467, 0.0696198,
    -0.20649727, 0.027588297, 0.12160779, 0.17547175, 0.13773969, 0.22891033, 0.15563288, 0.06562118, 0.09900057, -0.1993008, -0.034418058, 0.15664186, -0.043513685, 0.23223074, -0.2895335, 0.057588384, 0.20515661, 0.037300635,
    -0.11722369, 0.15554926, -0.014726221, -0.19246352, 0.10474843, -0.2464101, 0.08723694, 0.4000771, 0.36645418, 0.49083295, 0.39244664, 0.23561226, -0.43957862, -0.26303676, 0.026150497, 0.0639458, -0.0111092795, -0.208029,
    -0.048173636, 0.032575734, 0.012825103, -0.036577765, -0.111111306, 0.1591459, -0.09362528, 0.36357027, 0.27363178, 0.1613162, 0.013417955, 0.0029145537, -0.10983078, 0.095384784, -0.15905315, 0.1282905, 0.084064886, 0.1347836,
    0.06665297, 0.0019881728, -0.29919112, -0.1038992, -0.009057464, -0.018476626, -0.12844183, 0.6444625, 0.33483967, 0.3184417, -0.28653213, 0.19184574, 0.27944008, 0.07499734, 0.015268327, -0.009639615, -0.2957595, -0.24897097,
    0.00042107858, -0.17539392, -0.0455283, -0.041876223, 0.1223208, 0.032121636, 0.020156479, 0.2509098, 0.24549778, 0.23207198, -0.032835778, 0.24911708, -0.10286442, -0.10676276, -0.04155935, 0.06996361, -0.07678251, -0.042496957,
    0.038922194, -0.26945484, -0.1114984, 0.0085560875, 0.037596293, 0.077590235, -0.0760697, 0.29701105, 0.23592663, 0.26263404, -0.093575165, 0.21778275, 0.042781483, -0.1014889, -0.2103534, 0.046777826, 0.24008876, 0.23263676,
    0.09173591, -0.22939683, -0.27092385, -0.08619062, 0.19711298, 0.25237745, 0.08153643, 0.28182033, 0.50168943, 0.10747549, 0.12908497, 0.054277584, -0.0626167, -0.17120151, -0.20082611, -0.14203064, -0.042105436, -0.12709126,
    -0.14793953, 0.078251824, -0.022433545, 0.032741275, 0.06603892, 0.18663217, 0.08778073, 0.08198566, 0.31630117, 0.057645444, -0.22802056, 0.17292902, -0.05571787, -0.05899713, 0.019262489, -0.2801392, 0.007451859, 0.21511453,
    0.13367306, -0.11103907, -0.23995925, -0.101843625, -0.0043590046, -0.0049287337, -0.2878964, 0.2560841, 0.19154933, 0.41189137, 0.11210143, 0.22534633, -0.11285902, -0.054039136, -0.007066251, 0.18434846, 0.07765297, -0.30767342,
  };

  gru_r.Wnh = {
    0.18613303, -0.19123495, 0.23093764, -0.09199935, 0.013488777, 0.24278255, 0.37951383, 0.13851258, 0.15881264, 0.16645767, 0.08923694, 0.06359124, -0.2878704, -0.018200897, -0.2862906, 0.043134153, 0.13082802, 0.1034603,
    0.08244512, 0.1780837, 0.04955153, 0.06032708, 0.17441313, -0.22347146, 0.10212261, -0.31144676, -0.119518384, -0.29761046, -0.008001354, -0.23228261, 0.046780586, 0.19578171, -0.014558491, 0.097050846, -0.30324304, 0.0328268,
    0.12350533, 0.28648096, 0.45723608, -0.17468445, 0.10214896, 0.48923445, 0.23593986, 0.04412148, 0.12605298, -0.23601018, -0.09339908, 0.22304395, -0.031036787, 0.12923478, -0.3028148, -0.49946398, 0.042032037, 0.3991187,
    -0.12574108, -0.20478132, -0.29597884, -0.011881972, -0.18326688, 0.10805745, -0.22699718, 0.009856126, 0.018334327, 0.24102145, 0.25973704, -0.013949003, -0.037936155, 0.04641661, 0.069937184, 0.10043791, 0.10145584, -0.14017877,
    0.20670407, 0.18986034, -0.021878114, -0.1092469, 0.7912118, 0.15860385, 0.26678512, -0.37614962, 0.011236842, -0.32593024, 0.13105445, -0.32107693, 0.010703561, -0.1836521, -0.12050466, -0.47616106, -0.24878655, -0.22466129,
    -0.17146021, 0.28010485, 0.527228, 0.004247263, -0.11408485, 0.25041077, -0.1675904, 0.12432808, -0.25562108, 0.1612461, 0.47086266, 0.21995416, -0.6765154, 0.44479692, -0.032222904, -0.008045459, 0.3541241, -0.09743858,
    0.22389787, 0.040142555, -0.33690733, 0.22244425, 0.40314665, 0.68691987, -0.28773475, -0.02145814, 0.14661033, -0.20231332, -0.2606135, -0.13342747, 0.6707579, 0.3072201, -0.044963557, -0.8255096, -0.55996937, 0.11200065,
    0.09169713, -0.26585147, -0.11903908, -0.15222272, 0.27774584, 0.04700308, 0.09939831, 0.20150477, 0.21471581, 0.119932346, -0.009812236, -0.08703714, -0.25225636, -0.3430634, -0.0091787325, -0.08211023, 0.14976798, -0.075526245,
    -0.071720414, 0.31730726, -0.021310179, 0.12701853, -0.08097021, -0.15675598, -0.20621663, -0.08830468, -0.2264521, -0.09428029, -0.30184308, 0.09335327, 0.30361345, 0.112288006, 0.13071765, -0.1486701, -0.15487795, -0.1811784,
    -0.04897086, -0.41494393, -0.2593186, -0.13984291, -0.03225947, -0.02992217, 0.12166033, 0.107611604, 0.17261852, -0.48954222, -0.15229335, 0.095041625, -0.16070831, -0.019460998, -0.23198478, 0.20838447, 0.082850315, -0.15755093,
    0.05505309, -0.7217237, -0.5316676, 0.09837926, -0.36697367, -0.09600042, -0.10227829, 0.18562385, -0.10756055, -0.0032238862, -0.5835666, 0.026576368, 0.2904714, -0.2609963, -0.17281497, 0.32150376, 0.002391035, 0.39713418,
    -0.24315412, 0.09730171, 0.020979017, 0.31480336, 0.09418967, -0.08273303, 0.033326626, -0.0182661, -0.10084652, 0.17002952, -0.05498858, 0.45261326, 0.09545689, 0.3067095, -0.01779423, -0.03092753, -0.12592612, -0.10058269,
    0.15255591, 0.39827058, 0.29837, -0.53353983, 0.35973403, 0.27075562, 0.0017109701, -0.16512014, 0.043063264, -0.25007766, 0.6010658, -0.28707787, -1.0621576, 0.14205214, 0.07987488, -0.11931384, -0.05949038, -0.31024653,
    0.07290903, 0.31303713, 0.28477058, 0.054337643, -0.11404562, 0.11821092, 0.16204645, 0.084093615, -0.03185549, 0.06944765, 0.23610623, -0.0008591672, -0.08406266, 0.19164829, -0.16303696, -0.14676914, 0.025655158, 0.13351412,
    -0.13068363, 0.09062362, -0.21550435, 0.32286587, -0.63470286, -0.6855523, -0.17875898, 0.10792454, -0.13531433, 0.17533314, -0.1871229, 0.15055653, 0.2649715, 0.19912365, 0.29996437, 0.3467828, -0.12660557, -0.2258663,
    -0.061192084, 0.19621336, 0.44976568, 0.16001935, 0.09310218, -0.23216766, 0.449576, -0.066531256, -0.25873488, -0.32066205, -0.33698645, 0.13514154, 0.05897985, 0.3899244, -0.24172297, -0.024472198, -0.005762633, 0.598943,
    -0.09277223, -0.08374436, 0.30419195, 0.21598232, -0.41636443, 0.53400105, 0.06250209, -0.14755869, 0.07507921, -0.17350306, -0.015689325, 0.29086268, -0.03765328, 0.20351094, -0.19817689, 0.115544945, 0.35937908, 0.5559181,
    0.007442491, -0.0016350512, 0.03538609, -0.02595592, -0.17724201, 0.8515761, -0.65194976, 0.08553906, -0.003291464, -0.074172586, 0.28911695, 0.048227727, -0.030198123, 0.14424333, 0.12700018, -0.47239646, 0.35924432, -0.24509929,
  };

  gru_i.Wrx = {
    -0.01901332, 0.020996932, -0.113010824, -0.019314472, -0.050986037, -0.2018861, -0.085168205, -0.038237754, -0.044980437, -0.066760376, -0.010292208, 0.013435014, 0.031816076, -0.0981855, -0.006279458, -0.11520406, -0.0112433825, 0.035803083,
    0.0034736083, 0.031193648, 0.108492464, 0.018596193, 0.09974699, -0.027250815, -0.05201411, 0.12925795, 0.0314064, 0.08673149, 0.03694132, 0.17932127, -0.012740752, 0.06504942, -0.05103704, -0.055089585, 0.09569014, 0.09516698,
    -0.082677215, -0.106555544, -0.084976785, -0.044694882, -0.06975693, -0.040595118, -0.0012771006, -0.056031972, -0.06252728, 0.00048705656, -0.076385535, -0.06676537, -0.05675456, -0.044727374, 0.042211, -0.065717146, 0.038248755, 0.024561407,
    -0.12317518, -0.10649289, -0.14732441, -0.10320951, -0.19877192, -0.083876364, -0.09915595, -0.08033152, -0.10627198, -0.021610932, -0.12030882, -0.17226948, -0.081969835, -0.07675186, -0.0263423, -0.07345129, -0.06584154, -0.052756883,
    0.05616285, -0.02070851, -0.09873958, -0.013300626, -0.09625662, -0.16553739, -0.04526603, -0.060787596, -0.08867714, -0.036309753, 0.09772846, -0.06490962, 0.035006005, -0.1240468, -0.04651715, -0.04927495, -0.0018002666, 0.046246134,
    -0.051297385, -0.025114236, -0.061251827, -0.08049795, -0.06666071, 0.06762441, -0.035914913, -0.054751016, -0.050372314, -0.052570853, -0.06529963, -0.026614012, -0.011386657, 0.037851073, -0.02925184, 0.05802855, 0.009349162, -0.05951624,
    0.034359384, 0.020302814, -0.02007834, 0.007034509, -0.021734333, 0.03879224, -0.018429829, -0.011517017, -0.004411804, -0.005156703, 0.023111612, -0.011238918, 0.030604493, 0.02711091, 0.02589615, 0.03369865, 0.010509295, 0.051716104,
    0.007461753, -0.0011914164, -0.03844337, -0.0061261295, -0.11193664, -0.025052534, -0.042360332, -0.02584978, -0.044110186, -0.01354691, 0.010695264, -0.026356278, 0.021936655, -0.022932326, 0.0013149539, -0.0069093457, -0.0164361, 0.032451384,
    -0.028528694, 0.004184384, -0.0090954825, 0.0100711705, 0.04929892, -0.05044682, 0.0078065465, 0.004423904, 0.034658283, 0.03599864, -0.0126267215, -0.016590709, -0.046065103, -0.00015215196, -0.011345516, -0.07902826, 0.0010491457, 0.025574857,
    -0.034772035, -0.026262362, 0.08632884, 0.044813313, 0.06785083, -0.106631584, 0.013581287, 0.0043866406, 0.050315753, 0.07809685, 0.0049064416, 0.002085754, -0.0055206665, -0.07729023, 0.007431381, -0.094396986, -0.004152322, 0.004361914,
    0.009256245, -0.09723896, -0.028873967, -0.019556971, 0.029221497, -0.12536629, 0.06638226, -0.06356878, 0.05082628, -0.0033665632, 0.035054434, -0.045661367, 0.034056142, -0.1228815, -0.034184325, -0.1062558, 0.037335135, 0.010989239,
    -0.3200725, -0.29214862, -0.5183799, -0.4771045, -0.46935794, 1.2281955, -0.2632953, -0.36751327, -0.32640365, -0.28942263, -0.2753867, -0.3521941, 0.20917368, 0.99123776, -0.13719712, 0.65295136, -0.07454134, -0.19651581,
    -0.0498359, -0.03475737, -0.01737084, 0.008759462, -0.090816036, 0.16506697, -0.04526038, -0.057797525, -0.03059239, 0.00566263, -0.0075704, -0.06780147, 0.008880171, 0.14263761, 0.024149774, 0.06156299, -0.024423357, 0.017744128,
    0.11184921, 0.0754436, 0.09519123, 0.08391692, 0.013022267, -0.08216136, -0.05930864, 0.1344092, 0.012606602, -0.034830507, 0.069944665, 0.049125798, -0.025909867, -0.014179014, -0.004868728, -0.05340188, -0.03677028, 0.12141582,
    -0.084047526, -0.029630994, 0.0057933023, 0.060462106, -0.07108363, -0.07377869, 0.014861489, 0.0064786905, 0.040334407, 0.029219694, 0.034539767, 0.038118944, -0.038252354, -0.057294853, 0.082694374, -0.016110929, 0.03787699, 0.045423485,
    0.008214888, 0.009810178, 0.0347706, 0.03839365, -0.0007625425, 0.050510295, 0.027627803, 0.042311296, 0.05584354, 0.04365422, 0.02593217, 0.020662336, 0.010830167, 0.02828686, 0.078426525, 0.021524103, 0.057095315, 0.07465256,
    -0.0355271, 0.0030793343, -0.05755476, 0.0052211676, -0.058572672, -0.10468465, -0.0399683, -0.047583047, -0.044427563, -0.03898264, -0.010696355, -0.05307575, -0.0054411446, -0.07845018, -0.0132775, -0.016643114, -0.05817549, -0.047400583,
    -0.011521682, -0.016192248, -0.006997495, 0.0033928698, -0.01051885, 0.030203976, -0.013494701, 0.037689745, -0.027210873, 0.014470486, -0.02440969, 0.038331006, -0.003241353, 0.004402857, -0.005688887, -0.023897856, 0.02259595, 0.042444624,
  };

  gru_i.Wzx = {
    -0.018117594, -0.06210376, -0.042362027, -0.06536166, -0.03423062, 0.06379866, -0.032124117, -0.031552784, -0.02047126, 0.020422498, -0.020805577, -0.052979253, -0.02430551, -0.016772272, 0.012782942, 0.04119151, 0.004030063, -0.022312379,
    -0.042214718, 0.06125664, 0.020029832, -0.010229319, -0.0075750328, -0.0023731154, -0.035177436, 0.025963431, 0.014174486, 0.006907119, 0.010624724, 0.059098765, 0.04174946, 0.069871075, 0.017304612, -0.011480162, 0.010212172, 0.048104707,
    -0.022258885, -0.055365033, -0.07119088, -0.034224115, -0.06714419, -0.08107495, -0.041995745, -0.026457673, -0.11209567, -0.13738273, -0.009271587, -0.07780293, -0.032258403, -0.084284775, -0.23370254, -0.06090557, -0.1909601, -0.15337367,
    0.08050439, -0.0016184531, 0.01679614, 0.030203812, 0.0434676, -0.21505605, 0.012481264, 0.050685707, -0.030844193, -0.03652673, 0.019631075, 0.04428984, -0.112884894, -0.11811014, -0.1185672, -0.20553306, -0.11003031, -0.11883233,
    0.030914053, 0.053524204, 0.0043056663, -0.027592463, -0.013819807, 0.22209333, 0.05370563, -0.018900862, 0.014890554, -0.06327042, -0.06781955, -0.018006297, 0.039150685, 0.20529512, -0.027759459, 0.1458342, 0.07048663, -0.0073936507,
    -0.023776645, -0.004171896, 0.0424112, 0.008765864, 0.018902596, -0.12702034, 0.01849871, -0.008583174, -0.058349438, 0.00724293, -0.07497363, 0.03796163, -0.070244774, -0.039859883, -0.049755454, -0.12558565, -0.083538905, -0.024771342,
    -0.032750398, -0.04399759, -0.04107096, -0.077371486, -0.012939282, -0.004766455, -0.0020097364, -0.047623057, -0.09187193, -0.062254462, -0.020773087, -0.058512233, 0.015061015, -0.052796226, -0.19271427, 0.016827844, -0.1089066, -0.092742,
    0.059573382, 0.07854286, 0.013837628, -0.04123881, -0.05909827, 0.04082004, -0.06260986, 0.026969591, -0.017863961, -0.04622567, 0.086708434, -0.01194573, 0.10513757, 0.09406983, 0.03588221, 0.062869735, 0.010093336, 0.042322353,
    0.0338863, -0.04893489, -0.059000738, -0.10889278, -0.061026424, -0.055115074, -0.06650341, -0.021566119, -0.06684924, -0.05167894, -0.09639554, 0.002081452, -0.06994725, -0.03925917, -0.052990805, -0.08410959, -0.050125007, -0.06405223,
    -0.051023096, -0.05250939, -0.0001221212, -0.032458093, 0.03198815, 0.03754662, 0.026628455, -0.017932598, 0.020257264, -0.02523773, -0.034636278, -0.05872411, -0.025421144, 0.023619946, -0.100978024, -0.006518109, -0.012749111, -0.087448426,
    0.06996495, -0.014713583, 0.025835047, -0.022224216, 0.018031346, 0.1237328, 0.095832504, 0.015356537, 0.06621185, 0.010656158, -0.043765377, -0.08158504, 0.08540119, 0.059510462, -0.073992945, 0.11614364, 0.07448241, 0.02863235,
    -0.0069850753, 0.0035753213, 0.0013736051, 0.012586675, 0.019643672, -0.012612302, 0.0069216546, 0.0076747993, 0.00024828897, -0.0041967323, -0.04105931, 0.021542523, -0.031791855, 0.0040243235, -0.026259134, -0.03163331, -0.02762197, -0.018773878,
    0.0002605906, -0.036857214, -0.044849757, 0.0066699297, 0.0111776125, 0.017442385, -0.00978782, -0.018848043, 0.014200972, -0.0549064, -0.050333165, -0.037224635, -0.06461114, 0.025955878, -0.05544867, -0.07738233, -0.073415905, -0.091954686,
    0.11692302, -0.008231552, 0.07631818, 0.015295836, 0.014264559, 0.18295439, 0.045052134, 0.0531838, 0.021884227, -0.055565197, 0.024481172, -0.050873727, 0.09218075, 0.10581056, -0.06934798, 0.1565388, 0.028009206, -0.061374504,
    -0.06285326, -0.022201134, -0.07809143, -0.029478721, 0.0033281713, 0.0039093005, -0.014332523, -0.013177707, -0.017152626, -0.052024487, -0.045021795, -0.058927108, 0.0492857, 0.038053084, -0.007498303, 0.0069608293, -0.10658045, -0.034157466,
    -0.016234946, -0.06668421, -0.012292273, -0.011448399, 0.017304309, 0.008956081, 0.04305142, 0.0037451193, -0.020219844, -0.0043355217, -0.035992727, -0.099979304, 0.01130049, -0.004871606, -0.1197509, -0.0025207845, -0.05519257, -0.074135,
    -0.024597295, -0.020872155, 0.019820327, -0.021175258, 0.006861253, 0.03060496, 0.0064531965, 0.045295756, 0.02213404, -0.008737678, -0.020271957, -0.03185799, -0.010255095, 0.005516282, -0.029061697, 0.035153463, 0.010298807, 0.061517578,
    -0.019446874, 0.012909291, -0.03021304, 0.019070983, -0.029551117, 0.010514206, -0.061848428, -0.020363182, -0.027090503, -0.06597929, 0.0002718715, 0.0077106194, -0.08340397, 0.06482612, -0.02545344, -0.11605212, -0.08020388, -0.057217803,
  };

  gru_i.Wnx = {
    0.0015759588, 0.004996093, 0.004984121, 0.0046853777, 0.0044678454, -0.007808017, 0.0067250724, 0.008716053, 0.001590306, -0.0017864411, 0.0009279437, 0.0022823093, 0.002676384, -0.010064512, -0.0062350947, 0.0013858555, 0.0010901664, 0.008634212,
    0.0073851007, -0.014883031, -0.01305526, -0.0028604618, -0.003145383, -0.0031221376, 0.002232904, -0.019134704, -0.013037194, -0.023241153, -0.0057378514, -0.011977959, -0.0064684963, -0.016968288, 0.0018191622, -1.080654e-05, 0.0018675306, -0.011322077,
    0.8486946, 0.5888426, 0.5918295, 0.33366653, 0.42313036, 0.9186408, 0.11875224, 0.5920895, 0.15148386, -0.045233723, 0.54239273, 0.33838588, 0.5469415, 0.97510433, -0.05219326, 0.8616758, 0.12416183, 0.03454877,
    0.06498633, 0.21392804, 0.24255587, -0.004772902, 0.045986544, 1.1503592, 0.115711756, 0.12521666, 0.12283117, -0.07663518, 0.01256631, 0.2840536, 0.4596768, 0.9469005, 0.1586708, 0.8792759, 0.123094685, 0.15262721,
    0.12152589, 0.03464371, 0.11289097, 0.22301969, 0.04507669, -0.4242963, -0.0015366258, 0.1200004, -0.114142366, -0.053036, 0.199335, 0.119599685, -0.001214739, -0.4379153, -0.025267063, -0.016133256, -0.06695708, -0.008868999,
    0.06444942, 0.06617513, 0.0896881, -0.013292809, -0.012176965, 0.33327428, -0.00014255512, 0.09101259, 0.0709015, 0.00017796145, 0.067873344, 0.06455345, 0.1775258, 0.28278235, 0.04668306, 0.26004145, 0.025600959, 0.050956048,
    -0.6568662, -0.46414775, -0.3854107, -0.14671737, -0.23757705, -0.27167907, -0.098398454, -0.27195662, -0.08045099, -0.018368965, -0.43417433, -0.22447991, -0.3543064, -0.26741022, -0.14187843, -0.42794684, -0.1448158, -0.025244677,
    -0.5269974, -0.4848629, -0.27130884, -0.25957716, -0.11630109, -0.068640634, -0.055050295, -0.17209585, -0.14172287, -0.1046509, -0.4162707, -0.15302925, -0.41924283, -0.060477786, -0.050965562, -0.32899132, -0.11303555, -0.018825717,
    -0.03357318, -0.16758846, -0.20930055, -0.20354322, -0.049692206, -0.11362828, -0.16341302, -0.11794568, -0.010975614, 0.012561657, -0.0831931, -0.16582428, -0.1869091, 0.004155589, -0.040128615, -0.26052472, 0.0014378513, -0.07316918,
    0.07601746, 0.029513916, 0.01115711, 0.0330691, -0.10137233, 0.088278025, -0.06630519, -0.0038306331, -0.04486073, 0.04054277, 0.18543185, 0.08469375, 0.2230946, 0.09634894, 0.11750018, 0.15464671, 0.030305242, 0.18040998,
    -0.04555536, -0.023130335, 0.023811901, 0.14809577, 0.12755635, -0.077923715, 0.09565581, 0.052903585, 0.06044721, 0.0054071117, -0.13348523, -0.11372128, -0.10385978, -0.087864764, -0.1225692, -0.084665775, -0.030815085, -0.026304081,
    0.025913855, 0.011161878, 0.030070793, -0.0013158206, -0.0039603943, 0.06720548, 0.020901075, 0.0271513, 0.0051923664, 0.0074703833, 0.0250545, -0.0058109215, 0.037857622, 0.04576613, 0.0020485248, 0.060130697, 0.024376485, 0.024715142,
    -0.11157828, -0.079388596, -0.07173946, 0.033233225, 0.011911602, -0.13689926, -0.0041980254, -0.012300049, -0.011359753, -0.028913405, -0.12782083, -0.03313392, -0.18225202, -0.08115499, -0.07610156, -0.1577287, -0.110221274, -0.06588915,
    -0.13832623, -0.07108464, -0.14789172, -0.13854845, -0.064759135, 0.27988625, -0.034688905, -0.17148256, -0.0049046683, 0.0635578, -0.030221969, -0.119593844, 0.033032484, 0.27698442, 0.07522584, -0.030984424, 0.13501066, 0.031169286,
    0.42297128, 0.19938022, 0.24767034, 0.047784362, 0.26382312, 0.049812905, 0.015155995, 0.21427561, 0.028413896, 0.079837225, -0.0005623189, 0.10280467, 0.05497322, 0.03396686, -0.17861424, 0.0901688, 0.15158905, -0.06844493,
    0.11861813, 0.07626635, 0.07297029, -0.014379598, 0.08655756, 0.13498482, -0.03833499, 0.07739662, 0.051830787, 0.011884912, 0.005569328, 0.03568954, 0.12811528, 0.1357113, -0.023505656, 0.099661656, 0.06398454, 0.014061749,
    -0.38190633, -0.2636748, -0.2635519, -0.21548507, -0.20830306, 1.1889144, 0.1262094, -0.34915993, -0.015278224, 0.01642507, -0.39197594, -0.02770306, 0.23419411, 0.7427688, 0.09806819, 0.8288391, 0.08346198, 0.051891476,
    0.38990986, 0.3392404, 0.16327536, 0.13548699, 0.07886336, -0.0090037035, 0.11222856, 0.09823802, 0.105172954, -0.03820024, 0.26514965, 0.016835487, 0.28240627, -0.0041475534, 0.1282347, 0.16425152, 0.045454036, -0.05970911,
  };

  gru_i.Wrh = {
    0.4136307, 0.17291592, -0.0711837, -0.049232747, 0.19109476, -0.016680518, -0.06871946, -0.24952707, 0.09102556, 0.21107204, -0.25551674, 0.26479584, -0.15414697, 0.2519115, 0.0025862656, 0.10393098, -0.26845425, 0.13055417,
    0.07008054, 0.018629916, 0.0029642123, 0.00047678538, 0.1033174, -0.06472973, -0.016213601, -0.034021128, -0.019607391, -0.015871279, -0.049523436, -0.045584846, 0.016982257, 0.03549393, -0.019085594, -0.009725568, -0.07192312, -0.0062048403,
    0.10490267, 0.118205294, -0.35508436, -0.21133564, 0.104359254, -0.15734994, 0.04502797, 0.01397389, 0.13186437, -0.09481097, -0.13635175, 0.17109075, -0.056026753, 0.08566408, -0.22256714, -0.11582916, -0.07019696, -0.09387012,
    0.109564014, 0.06383881, -0.14336322, 0.09342346, -0.13479264, -0.002783694, 0.00687962, -0.0789529, 0.15671097, 0.12807898, -0.16887483, 0.07793825, -0.078901485, 0.31887555, -0.32980162, -0.018566733, 0.37720898, -0.0076490715,
    -0.025215391, 0.10630794, -0.052464616, -0.21414477, 0.31397954, -0.19517249, -0.11042503, -0.11293777, -0.046121117, 0.014191375, -0.09080421, -0.12074894, -0.052506976, -0.006900597, -0.062447034, -0.032105953, -0.33693802, 0.061803084,
    0.120096676, 0.114875235, 0.12867062, 0.10821025, 0.028224366, -0.037339844, -0.12172533, -0.12756269, 0.030125698, 0.11580405, -0.17518087, 0.018149903, -0.08463896, 0.25741306, -0.14443213, -0.0025713977, 0.08371454, 0.0797291,
    0.11454785, 0.08016565, -0.081724286, -0.1136438, 0.118688904, -0.1526262, -0.06606816, -0.07629122, 0.12564534, -0.09218551, -0.13190788, 0.11208661, -0.04213045, 0.06270197, -0.24392395, -0.118446015, -0.09687226, -0.029188972,
    0.23092714, 0.118414775, -0.13589378, -0.11195689, 0.21892583, -0.13113198, -0.11727463, -0.17146696, 0.10988434, -0.053553298, -0.18745428, 0.1509627, -0.09258155, 0.09846308, -0.24990775, -0.12403202, -0.19295368, 0.032871354,
    -0.04255406, 0.027169332, 0.098405, 0.010360352, 0.0011389033, -0.08174961, -0.08468259, -0.0367609, 0.047005907, 0.0009683556, -0.018915998, -0.116699025, 0.025732694, 0.01598854, -0.01579552, 0.027648987, 0.0049209376, 0.0367936,
    0.14598164, 0.07965954, -0.062908724, -0.07744237, 0.14189169, -0.12630834, -0.0061408374, -0.049292903, 0.062462967, 0.04040174, -0.080813594, 0.089731686, -0.01915687, 0.06269211, -0.071424216, -0.023741137, -0.18228674, 0.0044753696,
    0.22716336, 0.113914765, -0.04834442, -0.050602484, 0.090860665, -0.04898255, -0.07115585, -0.1446805, 0.023472466, 0.08266583, -0.16062108, 0.06418952, -0.107610404, 0.13613094, -0.036150895, 0.04527912, -0.11532778, 0.07799822,
    0.15711135, 0.08098221, 0.13684668, 0.3469641, 0.087175764, 0.2771476, 0.0896225, 0.030225717, -0.09376077, 0.06661701, -0.06623585, 0.3633924, 0.024559546, -0.006437158, 0.3006112, 0.20523946, -0.32244906, -0.1501843,
    0.01544291, 0.046938263, 0.127457, 0.11262025, -0.016860655, 0.010452689, -0.06560516, -0.07342854, -0.017820476, 0.050360113, -0.06681333, 0.041824926, -0.048055638, 0.08071207, -0.007193692, 0.052934695, 0.049856827, 0.057683095,
    0.2697625, 0.054635476, 0.086201444, -0.020691602, 0.2267611, -0.026671322, 0.02923254, -0.028137028, 0.0005459996, 0.15044627, -0.050842706, 0.114583835, -0.05640329, 0.055780992, 0.037078027, 0.072984606, -0.19811144, 0.02914398,
    0.038848616, 0.06740913, -0.0639515, 0.04973381, -7.5122465e-05, -0.0861402, -0.04655693, -0.027265975, 0.011221747, -0.012511085, -0.106851816, -0.045553476, -0.042876992, 0.10627943, -0.15504804, -0.060668685, 0.14691067, -0.0017080527,
    0.05568369, 0.076175466, 0.0041268817, 0.013890607, 0.048160873, -0.048540663, -0.08294335, -0.07573191, -0.010416135, 0.036747366, -0.101677895, 0.029780667, -0.063240506, 0.08308776, -0.038144384, 0.033157744, -0.047288176, 0.052953735,
    -0.14910838, 0.20443776, -0.21859024, -0.30030632, 0.2642036, -0.38882962, -0.17850602, -0.017687315, 0.054426104, -0.16612957, -0.19325478, -0.19312118, -0.021960607, 0.07540154, -0.35483268, -0.19579573, -0.24645403, -0.05914415,
    0.17978783, 0.101994164, -0.16345619, -0.010904388, 0.121998146, -0.12812462, -0.023841042, -0.041008003, 0.072932735, -0.00823214, -0.16411522, 0.16496395, -0.074935615, 0.12737997, -0.21177906, -0.067267045, -0.066850536, -0.011581016,
  };

  gru_i.Wzh = {
    -0.051664803, 0.13011031, 0.26538455, 0.19021836, 0.094811745, 0.10192517, -0.25968596, -0.1774648, -0.068066224, 0.2807852, -0.29853708, 0.21306995, -0.20221418, 0.2927094, -0.038160194, 0.16404001, -0.016417412, 0.21905488,
    -0.10396187, -0.15514718, -0.032141212, -0.015940728, -0.23758055, 0.06800521, 0.043201443, 0.049072575, 0.0034573725, -0.009063197, 0.08712702, 0.15312506, 0.00411952, 0.030350393, 0.0024780754, -0.01260645, 0.20322317, -0.025806578,
    -0.009702845, -0.23025782, -0.08131942, 0.07736093, -0.06727365, 0.38737467, 0.25996733, 0.14932255, -0.07848275, -0.008319004, 0.23408896, 0.23702791, 0.060333446, -0.21196705, 0.24658106, 0.027128117, 0.021713573, -0.08720217,
    -0.18887337, -0.23454998, 0.18507747, 0.20565525, -0.22421736, 0.3385, 0.13358302, 0.080419056, -0.09078869, -0.08225766, 0.27379254, 0.08945265, 0.12790224, -0.22417256, 0.24941115, 0.048937738, 0.17222553, -0.049413178,
    0.5291571, 0.14043209, 0.08038511, 0.16504486, 0.02157166, 0.14681314, -0.043638926, -0.24829847, 0.25702286, 0.23908503, -0.32210174, 0.96996325, -0.15289454, 0.45754805, -0.37339455, 0.05032357, -0.051857647, 0.061355762,
    -0.09838927, -0.081856854, 0.016284453, 0.11040268, -0.21110791, 0.008245341, 0.016610535, -0.019248398, -0.04604686, -0.09281534, 0.07125659, 0.06386531, 0.060151055, -0.040136013, 0.11805827, 0.0070209634, 0.19915025, 0.028489731,
    0.07593987, -0.09432673, -0.013763026, 0.018357217, 0.026279718, 0.18455754, 0.12700097, 0.023479484, -0.009231721, 0.01077932, 0.07800266, 0.1587041, 0.026808226, -0.074999236, 0.09942791, -0.0053592618, -0.040227983, -0.046475,
    0.27319893, 0.02483855, 0.37062353, 0.41917452, 0.2779281, 0.12756212, -0.28352675, -0.3503168, -0.000120100005, 0.19529966, -0.2080036, 0.33187118, -0.21807064, 0.11114249, -0.054451507, 0.108360775, 0.0065816646, 0.2029601,
    -0.07416547, -0.08257605, -0.0756213, -0.002253325, -0.19509862, 0.15778731, 0.09511813, 0.04526849, 0.026985323, -0.036115956, 0.06313997, 0.07851027, 0.032220297, -0.010676682, 0.015124604, 0.010547981, 0.18242212, -0.05788105,
    0.075981766, 0.015976163, -0.023639914, -0.00088233605, 0.051892366, -0.026964676, 0.033408448, -0.024149597, 0.026372658, -0.056686826, 0.0059924084, 0.106638975, 0.018035235, -0.01628982, -0.047458578, -0.05287346, -0.07523275, -0.03934188,
    0.08824051, 0.0035663615, 0.032705553, 0.029355537, 0.09763588, 0.06481409, -0.04297931, -0.103051126, -0.047042206, 0.0866016, -0.10754479, 0.110453516, -0.06910078, 0.06643089, 0.09444686, 0.07065948, -0.033693865, 0.09931182,
    -0.15393548, -0.090743266, -0.079498425, 0.18054213, -0.19201113, 0.6468795, 0.16647848, 0.18115215, -0.21839617, 0.03628383, 0.015977701, 0.6234047, -0.03617872, -0.021151422, 0.2681241, 0.1596353, 0.21282151, -0.08994545,
    0.023852756, -0.032653727, -0.007538966, 0.019897062, -0.017420407, 0.042253196, 0.033846084, -0.011792755, 0.049096372, -0.052664746, 0.029450826, 0.08225945, 0.026640723, 0.019078188, -0.032843262, -0.02611594, 0.070136786, -0.052162074,
    0.05349668, 0.014602798, -0.06642376, -0.0699317, 0.047461126, 0.01872421, -0.0058771046, -0.035289902, -0.009282774, 0.031713683, -0.030063698, 0.14075959, -0.041937485, 0.15281513, 0.028168399, 0.020883793, -0.011071072, 0.01849782,
    -0.12367132, -0.05190562, -0.037698213, 0.006659129, -0.110489264, 0.042770717, 0.05172608, 0.10698323, 0.007881644, -0.061501503, 0.0822743, -0.004620317, 0.05331659, -0.073466584, -0.02082993, -0.031873036, 0.100898586, -0.075045735,
    -0.080666944, -0.014280558, 0.101819895, 0.08781607, -0.075024374, -0.023804815, -0.06303479, -0.05330099, 0.029775916, -0.0682732, 0.0064964835, -0.009945993, 0.030325398, -0.03273653, -0.0026689654, 0.05090023, 0.11183761, 0.010781628,
    0.5093785, 0.12896125, 0.31587756, 0.4866687, 0.2400455, 0.23487025, -0.2412336, -0.33981803, 0.1344811, 0.4984813, -0.45327464, 1.0649012, -0.27238616, 0.4705029, -0.34265074, 0.18553652, 0.16704692, 0.21067953,
    0.09898723, 0.020040777, 0.119075395, 0.088586256, 0.080133386, -0.06197976, -0.047041353, -0.12110905, 0.0730181, -0.042757023, -0.070442244, 0.095123634, 0.03888734, 0.033365615, -0.10086176, -0.073551334, -0.041996952, -0.02351187,
  };

  gru_i.Wnh = {
    0.30099294, 0.14850004, -0.12896638, -0.10873358, 0.23977308, -0.057720035, -0.14579031, -0.29608583, 0.18163267, 0.30632207, -0.32079825, 0.22014572, -0.19855402, 0.22555172, 0.043023508, 0.15392137, -0.16574481, 0.30956408,
    0.2037032, -0.36410454, -0.051268477, -0.11942552, 0.12932561, -0.15856297, -0.032458574, -0.18837298, -0.0764806, 0.09171489, -0.0940752, -0.01583308, 0.021978918, 0.19313355, 0.11924334, -0.0019449826, -0.093106434, 0.009694717,
    -0.037074592, -0.12968935, 0.7101506, 0.6311286, 0.09732435, 0.33792576, -0.19371381, -0.13751067, -0.030397156, -0.031261392, 0.13616882, 0.17583278, 0.037677117, -0.054435574, -0.020998444, -0.019478044, -0.25399482, 0.12972906,
    0.09259733, -0.0113458065, 0.040388204, 0.39787102, -0.19107774, 0.16859889, 0.015214585, -0.09888145, 0.14758769, -0.34626865, 0.009646869, 0.5475607, -0.009543431, 0.015606844, -0.35402668, -0.14599662, 0.19445366, -0.09483426,
    0.3159345, 0.15797976, 0.01990042, -0.38448244, 0.20445423, -0.2489986, -0.07149859, -0.2006416, -0.15292573, -0.16343628, 0.016617168, -0.049331855, 0.061132077, -0.119497664, -0.04936059, -0.09593395, -0.62931675, 0.13994463,
    0.1372872, -0.023084365, -0.1100008, 0.16790514, -0.33222187, 0.027320785, 0.13443598, -0.0955468, 0.19808428, -0.08053413, 0.008728533, 0.46116045, 0.007092138, 0.104091324, -0.01049882, 0.15698867, 0.07269252, -0.06601288,
    -0.06631756, -0.14248678, -0.42195722, -0.028765557, -0.092731856, -0.024933217, 0.22483502, 0.26003736, -0.062622026, 0.097794406, 0.14125049, -0.13419196, 0.106463514, -0.077875815, 0.060391456, 0.083038576, 0.13780452, -0.1573524,
    0.033312537, -0.16963443, -0.41822138, 0.011121534, -0.13212657, -0.06632866, 0.4469519, 0.41036993, 0.015102582, -0.0390291, 0.16610871, -0.012913578, 0.2454235, -0.16370463, 0.0015854505, -0.06630312, 0.193339, -0.32645988,
    0.057194423, 0.012698042, 0.10369061, -0.07023791, -0.0032911364, -0.06838811, -0.06833868, -0.09191417, 0.1557685, 0.12976563, -0.12743057, -0.28353256, 0.0885482, 0.12661657, -0.114145786, 0.11823769, 0.17382877, 0.030103626,
    0.06824912, 0.002630657, 0.06194204, 0.07794335, 0.2702501, -0.03356582, -0.15688266, -0.33856574, 0.054296017, 0.10545303, -0.06102107, 0.12289046, 0.039748646, 0.054470304, 0.06617933, 0.105973125, -0.27219126, 0.2747256,
    -0.46397954, -0.16137825, 0.099911764, 0.11374316, -0.2041117, 0.014118621, 0.20104517, 0.21253942, -0.076615594, -0.114931546, 0.1099416, -0.21814331, 0.22420308, -0.19656837, 0.0610664, 0.016745845, 0.20628536, -0.073708,
    0.8455089, 0.32693836, -0.30202898, -0.18049417, 0.463882, -0.081062324, -0.056667436, -0.25179476, 0.21844359, 0.25580704, -0.3740627, -0.101086535, -0.32461935, 0.71874595, -0.53642696, 0.013661339, -0.15141353, -0.108379394,
    -0.2978085, -0.03611037, 0.102637105, 0.10146418, 0.09706895, -0.016186586, 0.047617525, 0.19893517, -0.117010035, 0.032951493, 0.18172567, -0.31799984, -0.04695426, -0.11765222, 0.0025754038, -0.04564285, 0.18563427, -0.07499982,
    0.49342456, 0.21316838, 0.030939212, 0.067057855, 0.19652633, 0.044334885, -0.11197384, -0.27434313, 0.121176176, 0.36962995, -0.28321615, 0.2607626, -0.21807306, 0.07623303, -0.10988313, 0.19641165, 0.15381055, 0.108699284,
    -0.12120716, -0.14639111, 0.11965099, -0.0050038765, -0.1227517, 0.303706, 0.034601375, 0.000245826, -0.052344196, 0.0020988225, 0.17854558, 0.29537213, 0.09692116, -0.22052637, 0.2438785, 0.21613237, -0.14452967, 0.06287459,
    0.12439081, -0.003792898, 0.25526643, -0.0328814, -0.15996626, 0.22158727, -0.13289785, -0.15460563, 0.17306492, -0.18331225, 0.088332795, 0.31158596, 0.00084270904, -0.07595738, 0.15850174, -0.15825059, -0.21882531, 0.025232546,
    -0.096939355, 0.0713372, 0.009550586, 0.43392274, -0.28295237, 0.11031077, 0.07452522, 0.12975352, -0.07913566, 0.036458965, -0.078677304, 0.1980721, -0.07173415, 0.3395683, -0.21822116, 0.060596477, 0.7972524, -0.15830038,
    0.1349371, 0.03807699, 0.41059306, -0.006436577, 0.074687205, 0.10935755, -0.26218474, -0.32360366, 0.047499057, 0.10672158, -0.04982025, 0.02282867, -0.014724896, 0.02039633, 0.024423154, 0.05640688, -0.119979486, 0.10735771,
  };

  gru_r.brx = {
    0.1390315,
    0.037228163,
    0.09235859,
    0.016405366,
    0.13598733,
    0.07231853,
    0.10178066,
    0.16983275,
    0.20828563,
    0.1507875,
    0.21417178,
    0.1484148,
    0.18584287,
    0.042914342,
    0.07631992,
    0.09693868,
    0.19087942,
    0.08382445,
  };

  gru_r.bzx = {
    -0.6346688,
    -0.70597076,
    -0.64382386,
    -0.569048,
    -0.63221055,
    -0.55820554,
    -0.6712173,
    -0.25188467,
    -0.6613281,
    -0.57626116,
    -0.6059821,
    -0.46851367,
    -0.60946107,
    -0.56466913,
    -0.48408443,
    -0.68988997,
    -0.2768174,
    -0.63153607,
  };

  gru_r.bnx = {
    -0.17330585,
    -0.08792631,
    0.13040099,
    0.18412957,
    -0.0019459112,
    0.16765219,
    0.14266326,
    -0.44820112,
    -0.42492124,
    -0.331193,
    0.16469437,
    -0.02947579,
    -0.29151407,
    0.41533616,
    -0.010508897,
    -0.3302171,
    0.11423908,
    0.020907622,
  };

  gru_r.brh = {
    0.13902825,
    0.027047813,
    0.091844715,
    0.01694523,
    0.13448358,
    0.0594993,
    0.10284779,
    0.16982403,
    0.20648055,
    0.15119684,
    0.21371959,
    0.14841467,
    0.1851163,
    0.042918228,
    0.07586368,
    0.10780206,
    0.18336667,
    0.0838306,
  };

  gru_r.bzh = {
    -0.6348846,
    -0.706702,
    -0.64232117,
    -0.56826466,
    -0.6060242,
    -0.5734386,
    -0.674169,
    -0.25252855,
    -0.66625416,
    -0.57613987,
    -0.57446206,
    -0.47246435,
    -0.60376465,
    -0.56520134,
    -0.4804837,
    -0.70247906,
    -0.2766891,
    -0.6319567,
  };

  gru_r.bnh = {
    -0.026328435,
    0.5380179,
    -0.09034806,
    0.15120359,
    -0.2954541,
    -0.09495459,
    0.080185056,
    -0.35989082,
    -0.7307166,
    -0.6396213,
    0.16077596,
    -0.10417982,
    -0.21417327,
    0.13198777,
    0.009641931,
    1.0532858,
    -0.16696239,
    0.21519439,
  };

  gru_i.brx = {
    -0.052138034,
    0.08285943,
    0.16488579,
    0.11102195,
    0.034020264,
    0.16980115,
    0.05835553,
    0.09520541,
    0.06359641,
    0.09817219,
    0.10874577,
    -0.061246693,
    0.07405309,
    -0.04828605,
    0.14262523,
    0.16077922,
    0.012805977,
    0.013878972,
  };

  gru_i.bzx = {
    -0.096371755,
    -0.2870117,
    -0.5971704,
    -0.4505289,
    -0.14024466,
    -0.1736857,
    -0.43857476,
    -0.037452895,
    -0.08844157,
    -0.091489986,
    -0.15469915,
    -0.61696947,
    -0.13437448,
    -0.18851657,
    -0.12370116,
    -0.23268558,
    -0.3386508,
    -0.12936741,
  };

  gru_i.bnx = {
    -0.19503143,
    0.23619564,
    -0.10397597,
    -0.11321902,
    0.006365573,
    -0.48657233,
    0.0349732,
    0.13283211,
    0.099632636,
    -0.09008716,
    -0.12994507,
    -0.61247534,
    0.0119505515,
    0.18836921,
    -0.22934236,
    0.004542944,
    -0.10299248,
    -0.03548061,
  };

  gru_i.brh = {
    -0.05095629,
    0.08290379,
    0.16744983,
    0.109730996,
    0.025737494,
    0.16949236,
    0.062581755,
    0.07854597,
    0.06494825,
    0.09842416,
    0.10679311,
    -0.061274625,
    0.073993914,
    -0.047716677,
    0.14268324,
    0.16077921,
    0.014968867,
    0.018686354,
  };

  gru_i.bzh = {
    -0.105139755,
    -0.28697312,
    -0.5971641,
    -0.45073846,
    -0.14673592,
    -0.16966872,
    -0.43856487,
    -0.12330894,
    -0.09048335,
    -0.09211112,
    -0.1542338,
    -0.6116645,
    -0.13381332,
    -0.18492395,
    -0.123945765,
    -0.23336866,
    -0.35467967,
    -0.12954527,
  };

  gru_i.bnh = {
    -0.041776527,
    0.24761419,
    -0.033032205,
    -0.37817982,
    -0.110103756,
    -0.392083,
    -0.006870139,
    0.14255987,
    0.038781844,
    -0.31236863,
    -0.09052987,
    -0.11772368,
    0.0648605,
    -0.09784114,
    -0.05226595,
    -0.036152784,
    0.074522935,
    -0.12917884,
  };
}

ComplexGRU::~ComplexGRU() {}

std::vector<float>& ComplexGRU::get_out_re() {
  return out_real;
}

std::vector<float>& ComplexGRU::get_out_im() {
  return out_imag;
}

void ComplexGRU::forward(V x_real, V x_imag, V h_rr, V h_ir, V h_ri, V h_ii) {
  // x shape is numBins*fc_dim
  // h_rr shape is numBins*fc_dim
  gru_r.forward(x_real, h_rr);
  h_rr = gru_r.get_h();

  gru_r.forward(x_imag, h_ir);
  h_ir = gru_r.get_h();

  gru_i.forward(x_real, h_ri);
  h_ri = gru_i.get_h();

  gru_i.forward(x_imag, h_ii);
  h_ii = gru_i.get_h();

  subtract_vector(out_real, h_rr, h_ii);
  add_vector(out_imag, h_ri, h_ir);
}
